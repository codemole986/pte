<app-header></app-header>
<section class="main-container">
    <div [@routerTransition]>
        <div *ngIf="(!newproblem && !editproblem)" >
            <h3 class="page-title">Quiz Manage <small> <a [routerLink]="['/']" style="text-decoration: none;"><i class="fa fa-home"></i> Home </a><i class="fa fa-angle-right"></i> Manage <i class="fa fa-angle-right"></i><a [routerLink]="['/quizlist']" style="text-decoration: none;"> Quiz </a></small></h3>
            <hr/>            
            <div class="row">
                <div class="col-lg-12">
                    <div class="card card-default mb-3">
                        <div class="card-header">
                            <div class="caption">
                                <i class="fa fa-table fa-fw"></i> Quiz List
                            </div>                            
                            <div class="actions">
                                <a href="javascript:;" class="btn btn-default btn-sm" (click)="onClickExercise()">
                                <i class="fa fa-youtube-play fa-fw"></i> Exercise </a>
                                <a *ngIf="actionflag" href="javascript:;" class="btn btn-default btn-sm" (click)="onClickPreview()">
                                <i class="fa fa-play fa-fw"></i> Preview </a>
                                <a *ngIf="actionflag" href="javascript:;" class="btn btn-default btn-sm" (click)="showAddProblemForm()">
                                <i class="fa fa-plus fa-fw"></i> Add </a>  
                                <a *ngIf="actionflag" href="javascript:;" class="btn btn-default btn-sm" (click)="showEditProblemForm();"><i class="fa fa-edit fa-fw"></i> Edit </a>
                                <a *ngIf="actionflag" href="javascript:;" class="btn btn-default btn-sm" (click)="onClickDelete();"> <i class="fa fa-trash-o fa-fw"></i> Delete </a>                              
                            </div>                           
                            
                        </div>
                        <div class="card-body">
                            <ng2-smart-table [settings]="quizgridsettings" [source]="quizdatasource" (userRowSelect)="onQuizRowSelect($event)"></ng2-smart-table> 
                        </div>
                    </div>
                </div>
            </div>
        </div>        
    
    <form *ngIf="newproblem" novalidate #problemaddForm="ngForm">
        <h3 class="page-title">Quiz Add <small> <a [routerLink]="['/']" style="text-decoration: none;"><i class="fa fa-home"></i> Home </a><i class="fa fa-angle-right"></i> Manage <i class="fa fa-angle-right"></i><a href="javascript:void(0)" (click)="onClickList()" style="text-decoration: none;"> Quiz </a> <i class="fa fa-angle-right"></i><a href="javascript:void(0)" style="text-decoration: none;"> Add </a> </small></h3>        
        <hr/>
        <nav class="navbar-expand-md">
            <ul class="navbar-nav ml-auto" style="background-color: #dff;">
                <li class="nav-item dropdown" ngbDropdown>
                    <a href="javascript:void(0)" class="nav-link" ngbDropdownToggle>
                        <i class="fa fa-keyboard-o"></i> {{ 'Writing' | translate }} <b class="caret"></b>
                    </a>
                    <div class="dropdown-menu dropdown-menu-left">
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Writing', 'WSM')">
                            {{ 'Summarize Written Text' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Writing', 'WES')">
                            {{ 'Write Essay' | translate }}
                        </a>
                    </div>
                </li>
                <li class="nav-item dropdown" ngbDropdown>
                    <a href="javascript:void(0)" class="nav-link" ngbDropdownToggle>
                        <i class="fa fa-headphones"></i> {{ 'Listening' | translate }} <b class="caret"></b>
                    </a>
                    <div class="dropdown-menu dropdown-menu-left">
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Listening', 'LWS')">
                            {{ 'Listen and Write a Summary' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Listening', 'LSA')">
                            {{ 'Listen and Select Answer' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Listening', 'LTW')">
                            {{ 'Listen and Type Words' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Listening', 'LSB')">
                            {{ 'Listen and Select the Best' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Listening', 'LCD')">
                            {{ 'Listen and Click Differ' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Listening', 'LTS')">
                            {{ 'Listen and Type Sentence' | translate }}
                        </a>
                    </div>
                </li>
                <li class="nav-item dropdown" ngbDropdown>
                    <a href="javascript:void(0)" class="nav-link" ngbDropdownToggle>
                        <i class="fa fa-eye"></i> {{ 'Reading' | translate }} <b class="caret"></b>
                    </a>
                    <div class="dropdown-menu dropdown-menu-left">
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Reading', 'RSA')">
                            {{ 'Read and Single Answer' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Reading', 'RMA')">
                            {{ 'Read and Multiple Answer' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Reading', 'RRO')">
                            {{ 'Read and Restore Order' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Reading', 'RFB')">
                            {{ 'Read and Fill in the Blanks' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Reading', 'RAN')">
                            {{ 'Read and Select Answer' | translate }}
                        </a>
                    </div>
                </li>
                <li class="nav-item dropdown" ngbDropdown>
                    <a href="javascript:void(0)" class="nav-link" ngbDropdownToggle>
                        <i class="fa fa-volume-up"></i> {{ 'Speaking' | translate }} <b class="caret"></b>
                    </a>
                    <div class="dropdown-menu dropdown-menu-left">
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Speaking', 'SAL')">
                            {{ 'Speak Aloud' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Speaking', 'SRS')">
                            {{ 'Repeat Sentence' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Speaking', 'SPI')">
                            {{ 'Speak about Picture' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Speaking', 'SRL')">
                            {{ 'Retell about Lecture' | translate }}
                        </a>
                        <a class="dropdown-item" href="javascript:void(0)" (click)="onSelectProbCategory('Speaking', 'SSA')">
                            {{ 'Speak Shot Answer' | translate }}
                        </a>
                    </div>
                </li>
                <div style="padding: .5rem 1.5rem;
                    background-color: #dff;
                    color: #007bff;
                    position: absolute;
                    right: 15px;
                    font-weight: 600;">
                <i class="fa {{getCategoryIconClass(editedProblem.category)}}"></i> {{ editedProblem.category }} / {{ getTypeName(editedProblem.category, editedProblem.type) }}
                </div>
            </ul>
        </nav>
        <hr/>  
        <div class="row">
            <div class="col-lg-12">
                <div class="card card-default mb-3">
                    <div class="card-header">
                        <i class="fa fa-cog fa-fw"></i> Global Setting 
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-sm-5 mb-3">
                                <input name="title" id="title" class="form-control needfull" placeholder=" * Title" title="Title" [(ngModel)]="editedProblem.title" required autofocus reverse="true" maxlength="255" #title="ngModel">
                                <small [hidden]="title.valid || (title.pristine && savefalg)" class="text-danger">
                                    Title is required for 1~255 chars.
                                </small>
                            </div>
                            <div class="col-sm-3">
                                <select name="degree" class="form-control needfull" title="Degree" [(ngModel)]="editedProblem.degree" required reverse="true" #degree="ngModel">
                                    <option *ngFor="let d of pdegree" [ngValue]="d.value" ng-selected="d.vaule==editedProblem.degree">{{d.title}}</option>
                                </select>
                                <small [hidden]="degree.valid || (degree.pristine && savefalg )" class="text-danger">
                                    Degree is required.
                                </small>
                            </div>
                            <div class="col-sm-2 mb-3">
                                <input type="number" min="0" name="limit_time" class="form-control needfull" placeholder=" * LimitTime" title="LimitTime" [(ngModel)]="editedProblem.limit_time" required reverse="true" #limit_time="ngModel">
                                <small [hidden]="limit_time.valid || (limit_time.pristine && savefalg )" class="text-danger">
                                    Limit Time is required.
                                </small>
                            </div>
                            <div class="col-sm-2">
                                <input type="number" min="0" name="points" class="form-control needfull" placeholder="* Points" title="Points" [(ngModel)]="editedProblem.points" required reverse="true" #points="ngModel">
                                <small [hidden]="points.valid || (points.pristine && savefalg)" class="text-danger">
                                    Points is required.
                                </small>
                            </div>
                        </div>
                        <textarea name="guide" class="form-control" placeholder="Guide" title="Guide" rows="3" [(ngModel)]="editedProblem.guide"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="card card-default mb-3">
                    <div class="card-header">
                        <i class="fa fa-edit fa-fw"></i> Edit of Problem 
                    </div>
                    <div class="card-body">
                        <div *ngIf="editedProblem.type == 'WSM' || editedProblem.type =='WES' || editedProblem.type =='SAL'">
                            <textarea name="sentences" class="form-control needfull" placeholder="Text" title="Text" rows="5" [(ngModel)]="editedProblem.content.text"></textarea>
                        </div>
                        <div *ngIf="editedProblem.type =='SRS' || editedProblem.type =='SSA' || editedProblem.type =='LWS' || editedProblem.type =='LSA' || editedProblem.type =='LTW' || editedProblem.type =='LSB' ||  editedProblem.type =='LCD' || editedProblem.type =='LTS'">
                            <p class="form-group my-2" style="width: 100%;">
                                Select a Audio (mp3/wav): 
                            </p>
                            <div class="dropzone" id="dzaudiofile"></div>       
                        </div>                        
                        <div *ngIf="editedProblem.type =='SRL'">
                            <div class="row">
                                <input type="text" name="sentences" class="form-control" placeholder="Text" title="Text" [(ngModel)]="editedProblem.content.text" />
                                
                                <p class="form-group my-2" style="width: 100%;">
                                    Select a Audio : 
                                </p>
                                <fieldset class="form-group my-6 needfull">
                                    <input filestyle="" type="file" data-button-text="Single" data-class-button="btn btn-default" data-classinput="form-control inline" nv-file-select="" class="form-control" #lectureproblemFile id="lectureproblemFile" />
                                </fieldset>                                      
                            </div>
                        </div>
                        <div *ngIf="editedProblem.type == 'RSA'  ||  editedProblem.type =='RMA' || editedProblem.type =='SPI'">
                            <div *ngIf="editedProblem.type == 'RSA'  ||  editedProblem.type =='RMA'">
                                <textarea name="sentences" class="form-control" placeholder="Text" title="Text" rows="3" [(ngModel)]="editedProblem.content.text"></textarea>
                            </div>
                            <p class="form-group my-2" style="width: 100%;">
                                Select a Picture (jpeg/jpg/png): 
                            </p>
                            <div class="dropzone" id="dzpicturefile"></div>                            
                            <hr/>
                            <div *ngIf="editedProblem.type == 'RSA'  ||  editedProblem.type =='RMA'">
                                <textarea name="select_guide" class="form-control" placeholder="Guide for multiple-choice" title="Guide for multiple-choice" rows="2" [(ngModel)]="editedProblem.content.select.guide"></textarea>
                                <label style="margin-top: 10px;"> List of candidates </label>
                                <select id="select_options" name="list_sentences" class="form-control" (change)="onChangeProbSelect()" [(ngModel)]="select_problem_values" multiple>
                                    <option *ngFor="let op of editedProblem.content.select.options" value="{{op}}">{{op}}</option>
                                </select>
                                <div class="form-group input-group">
                                    <input id="option_sentence" name="optionSentence" #optionsentence class="form-control mr-2" placeholder="Sentence" title="Sentence" [(ngModel)]="strOptionSentence">
                                    <p class="form-group my-2">
                                        <button class="btn btn-sm btn-success" type="button" (click)="onAddOption()"><i class="fa fa-plus-square fa-fw"></i> Add</button>
                                        <button id="btnEditOption" class="btn btn-sm btn-success" type="button" (click)="onEditOption()" *ngIf="show_editoption" [disabled]="dis_editoption"><i class="fa fa-pencil-square fa-fw"></i> Edit</button>
                                        <button id="btnChangeOption" type="button" class="btn btn-sm btn-success" (click)="onChangeOption()" *ngIf="show_chngoption"><i class="fa fa-pencil-square fa-fw"></i> Change</button>
                                        <button id="btnDeleteOption" type="button" class="btn btn-sm btn-success" (click)="onDeleteOption()" [disabled]="dis_deleteoption"><i class="fa fa-minus-square fa-fw"></i> Delete</button>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="editedProblem.type == 'LSA' || editedProblem.type == 'LSB'">
                            <textarea name="select_guide" class="form-control" placeholder="Guide for multiple-choice" title="Guide for multiple-choice" rows="2" [(ngModel)]="editedProblem.content.select.guide"></textarea>
                            <label style="margin-top: 10px;"> List of candidates </label>
                            <select id="select_options" name="list_sentences" class="form-control" (change)="onChangeProbSelect()" [(ngModel)]="select_problem_values" multiple>
                                <option *ngFor="let op of editedProblem.content.select.options" value="{{op}}">{{op}}</option>
                            </select>
                            <div class="form-group input-group">
                                <input id="option_sentence" name="optionSentence" #optionsentence class="form-control mr-2" placeholder="Sentence" title="Sentence" [(ngModel)]="strOptionSentence">
                                <p class="form-group my-2">
                                    <button class="btn btn-sm btn-success" type="button" (click)="onAddOption()"><i class="fa fa-plus-square fa-fw"></i> Add</button>
                                    <button id="btnEditOption" class="btn btn-sm btn-success" type="button" (click)="onEditOption()" *ngIf="show_editoption" [disabled]="dis_editoption"><i class="fa fa-pencil-square fa-fw"></i> Edit</button>
                                    <button id="btnChangeOption" type="button" class="btn btn-sm btn-success" (click)="onChangeOption()" *ngIf="show_chngoption"><i class="fa fa-pencil-square fa-fw"></i> Change</button>
                                    <button id="btnDeleteOption" type="button" class="btn btn-sm btn-success" (click)="onDeleteOption()" [disabled]="dis_deleteoption"><i class="fa fa-minus-square fa-fw"></i> Delete</button>
                                </p>
                            </div>
                        </div>
                        <div *ngIf="editedProblem.type == 'RRO'">
                            <label> List of target </label>
                            <div class="form-group input-group">
                                <table>
                                <tr><td style="width: 100%;">
                                <select id="select_options" name="list_sentences" class="form-control" (change)="onChangeProbSelect()" rows="10" [(ngModel)]="select_problem_values" style="width: 100%;" multiple>
                                    <option *ngFor="let op of editedProblem.content.select.options" value="{{op}}">{{op}}</option>
                                </select>
                                </td><td>
                                <table>
                                <tr><td style="padding-left: 5px;">
                                    <button class="btn btn-sm btn-success" type="button" (click)="onUpOption()"><i class="fa fa-chevron-up fa-fw"></i></button>
                                </td></tr>
                                <tr><td style="padding-left: 5px;">
                                    <button class="btn btn-sm btn-success" type="button" (click)="onDownOption()"><i class="fa fa-chevron-down fa-fw"></i></button>
                                </td></tr>
                                </table>
                                </td></tr>
                                </table>
                            </div>
                            <div class="form-group input-group">
                                <input id="optionsentence" name="optionsentence" #optionsentence class="form-control" placeholder="Sentence" title="Sentence" [(ngModel)]="strOptionSentence">
                                <p class="form-group my-2">
                                    <button class="btn btn-sm btn-success" type="button" (click)="onAddOption()"><i class="fa fa-plus-square fa-fw"></i> Add</button>
                                    <button id="btnEditOption" class="btn btn-sm btn-success" type="button" (click)="onEditOption()" *ngIf="show_editoption" [disabled]="dis_editoption"><i class="fa fa-pencil-square fa-fw"></i> Edit</button>
                                    <button id="btnChangeOption" type="button" class="btn btn-sm btn-success" (click)="onChangeOption()" *ngIf="show_chngoption"><i class="fa fa-pencil-square fa-fw"></i> Change</button>
                                    <button id="btnDeleteOption" type="button" class="btn btn-sm btn-success" (click)="onDeleteOption()" [disabled]="dis_deleteoption"><i class="fa fa-minus-square fa-fw"></i> Delete</button>
                                </p>
                            </div>
                        </div>
                        <div *ngIf="editedProblem.type == 'RFB'  ||  editedProblem.type == 'LTW'  ||  editedProblem.type == 'LCD'">
                            <textarea id="ck_editor" class="form-control" placeholder="Sentences" title="Sentences" rows="5"></textarea>
                            <div class="row">
                                <div class="col-sm-4"></div>
                                <div class="input-group col-sm-4">
                                    <input *ngIf="editedProblem.type == 'RFB'" class="form-control my-2" name="blank" placeholder="Blank" title="Blank" [(ngModel)]="str_blank" disabled>
                                    <input *ngIf="editedProblem.type == 'LTW'" class="form-control my-2" name="blank" placeholder="Blank" title="Blank" [(ngModel)]="str_blank">
                                    <input *ngIf="editedProblem.type == 'LCD'" class="form-control my-2" name="differ" placeholder="Differ" title="Differ" [(ngModel)]="str_blank">
                                    <button class="btn btn-sm btn-success my-2" type="button" (click)="onBlankClick()"><i class="fa fa-plus-square fa-fw"></i> Add</button>
                                </div>
                                <div class="col-sm-4"></div>
                            </div>
                            <div *ngIf="editedProblem.type == 'RFB'" class="row">
                                <div class="col-sm-3"></div>
                                <div class="col-sm-6">
                                    <label> List of candidates </label>
                                    <select id="select_options" name="list_sentences" class="form-control" (change)="onChangeProbSelect()" [(ngModel)]="select_problem_values" multiple>
                                        <option *ngFor="let op of editedProblem.content.select.options" value="{{op}}">{{op}}</option>
                                    </select>
                                    <div class="form-group input-group">
                                        <input id="optionsentence" name="optionsentence" #optionsentence class="form-control mr-2" placeholder="Sentence" title="Word" [(ngModel)]="strOptionSentence">
                                        <p class="form-group my-2">
                                            <button class="btn btn-sm" type="button" (click)="onAddOption()"><i class="fa fa-plus-square fa-fw"></i> Add</button>
                                            <button id="btnEditOption" class="btn btn-sm" type="button" (click)="onEditOption()" *ngIf="show_editoption" [disabled]="dis_editoption"><i class="fa fa-pencil-square fa-fw"></i> Edit</button>
                                            <button id="btnChangeOption" type="button" class="btn btn-sm" (click)="onChangeOption()" *ngIf="show_chngoption"><i class="fa fa-pencil-square fa-fw"></i> Change</button>
                                            <button id="btnDeleteOption" type="button" class="btn btn-sm" (click)="onDeleteOption()" [disabled]="dis_deleteoption"><i class="fa fa-minus-square fa-fw"></i> Delete</button>
                                        </p>
                                    </div>
                                </div>
                                <div class="col-sm-3"></div>
                            </div>
                            {{createCkEditor()}}
                        </div>
                        <div *ngIf="editedProblem.type == 'RAN'">
                            <textarea id="ck_editor" class="form-control" placeholder="Sentences" title="Sentences" rows="5"></textarea>
                            <table width="100%" anign="center" style="margin-top: 5px;"><tr>
                                <td width="45%">
                                    <label> List of candidates </label>
                                    <div class="form-group input-group">
                                        <table>
                                        <tr><td style="width: 100%;">
                                        <select name="list_sentences" class="form-control" (change)="onChangeBlankSelect()" [(ngModel)]="select_blank_values" style="width: 100%;" multiple>
                                            <option *ngFor="let op of select_blank_options" value="{{op}}">{{op}}</option>
                                        </select>
                                        </td><td>
                                        <table>
                                        <tr><td style="padding-left: 5px;">
                                            <button class="btn btn-sm" type="button" (click)="onUpBlank()"><i class="fa fa-chevron-up fa-fw"></i></button>
                                        </td></tr>
                                        <tr><td style="padding-left: 5px;">
                                            <button class="btn btn-sm" type="button" (click)="onDownBlank()"><i class="fa fa-chevron-down fa-fw"></i></button>
                                        </td></tr>
                                        </table>
                                        </td></tr>
                                        </table>
                                    </div>
                                    <div class="form-group input-group">
                                        <input name="optionsentence" id="optionsentence" #optionsentence class="form-control mr-2" placeholder="Word" title="Word" [(ngModel)]="strOptionSentence">
                                        <p class="form-group my-2">
                                            <button class="btn btn-sm" type="button" (click)="onAddBlank()"><i class="fa fa-plus-square fa-fw"></i> Add</button>
                                            <button class="btn btn-sm" type="button" (click)="onEditBlank()" *ngIf="show_editoption" [disabled]="dis_editoption"><i class="fa fa-pencil-square fa-fw"></i> Edit</button>
                                            <button type="button" class="btn btn-sm" (click)="onChangeBlank()" *ngIf="show_chngoption"><i class="fa fa-pencil-square fa-fw"></i> Change</button>
                                            <button type="button" class="btn btn-sm" (click)="onDeleteBlank()" [disabled]="dis_deleteoption"><i class="fa fa-minus-square fa-fw"></i> Delete</button>
                                        </p>
                                    </div>
                                </td>
                                <td width="10%" align="center">
                                    <button class="btn btn-sm btn-success" type="button" (click)="onAddSelectToList()"> Add <i class="fa fa-chevron-right fa-fw"></i></button>
                                </td>
                                <td width="45%">
                                    <table class="table table-bordered table-hover table-striped">
                                    <thead>
                                        <th> Select</th>
                                        <th> Action</th>
                                    </thead>
                                    <tr *ngFor="let blank_select of blank_selectlist; let i = index">
                                        <td>
                                            <select name="list_sentences{{i}}" class="form-control" (change)="onChangeProbSelect()" [(ngModel)]="blank_select.select_value" style="width: 100%;">
                                                <option *ngFor="let op of blank_select.options" value="{{op}}" selected="blank_select.select_value=={{op}}">{{op}}</option>
                                            </select>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-warning"
                                                (click)="onAddSelect($event, i)">
                                                <i class="fa fa-chevron-up fa-fw"></i> Add
                                            </button>
                                            <button class="btn btn-sm btn-warning"
                                                (click)="onDeleteSelect(i)">
                                                <i class="fa fa-minus-square fa-fw"></i> Delete
                                            </button>
                                        </td>
                                    </tr>
                                </table>
                                </td>
                                </tr>
                            </table>
                            {{createCkEditor()}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="card card-default mb-3">
                    <div class="card-header">
                        <i class="fa fa-circle-o fa-fw"></i> Solution of Problem 
                    </div>
                    <div class="card-body">
                        <div *ngIf="editedProblem.type == 'WSM' || editedProblem.type == 'WES' || editedProblem.type == 'LWS' || editedProblem.type == 'LTS'">
                            <textarea name="solution" class="form-control" placeholder="Solution Sentences" title="Solution Sentences" rows="5" [(ngModel)]="editedProblem.solution.text"></textarea>
                        </div>
                        <div *ngIf="editedProblem.type == 'SAL' || editedProblem.type == 'SRS' || editedProblem.type == 'SPI' || editedProblem.type == 'SSA'">
                            <div class="row">
                                <p class="form-group my-2" style="width: 100%;">
                                    Select a Audio (mp3/wav): 
                                </p>
                                <div class="dropzone" id="dzsolutionfile" style="width: 100%;"></div>                                
                            </div>
                        </div>
                        <div *ngIf="editedProblem.type == 'RSA' || editedProblem.type == 'LSB'">
                            <select id="select_solution_singleoptions" name="list_sentences" class="form-control" (change)="onChangeSolutionSelect()" [(ngModel)]="select_solution_value">
                                <option *ngFor="let op of editedProblem.content.select.options" ng-selected="op==select_value" value="{{op}}">{{op}}</option>
                            </select>
                        </div>
                        <div *ngIf="editedProblem.type == 'RMA' || editedProblem.type == 'LSA'">
                            <select id="select_solution_multipleoptions" name="list_sentences" class="form-control" (change)="onChangeSolutionMultipleSelect()" [(ngModel)]="select_solution_values" multiple>
                                <option *ngFor="let op of editedProblem.content.select.options" ng-selected="for(var i = 0;  i < select_values.length;  i++){ if(op==select_values[i]) return true;} return false;" value="{{op}}">{{op}}</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <hr/>
        <div class="row">
            <div class="col text-right">
                <p class="ng-tns-c14-20 my-2">
                    <button class="btn btn-sm btn-primary" type="button" (click)="onClickList()"><i class="fa fa-table fa-fw"></i> List</button>
                    <button class="btn btn-sm btn-primary" type="button" (click)="onClickSave()"><i class="fa fa-save fa-fw"></i> Save </button>
                    <!-- <button class="btn btn-sm btn-primary" type="button" [disabled]="savefalg" (click)="onClickPreview()"><i class="fa fa-play fa-fw"></i> Preview </button>                     -->
                </p>
            </div>
        </div>
    </form>

    <form *ngIf="editproblem" novalidate #problemeditForm="ngForm">
        <input name="id" type="hidden" class="form-control" [(ngModel)]="editedProblem.id">
        <h3 class="page-title">Quiz Add <small> <a [routerLink]="['/']" style="text-decoration: none;"><i class="fa fa-home"></i> Home </a><i class="fa fa-angle-right"></i> Manage <i class="fa fa-angle-right"></i><a href="javascript:void(0)" (click)="onClickList()" style="text-decoration: none;"> Quiz </a><i class="fa fa-angle-right"></i><a href="javascript:void(0)" style="text-decoration: none;"> Edit </a></small></h3>                
        <hr/>
        <div style="padding: .5rem 1.5rem; background-color: #dff; color: #007bff; font-weight: 600;">
        <i class="fa {{getCategoryIconClass(editedProblem.category)}}"></i> {{ editedProblem.category }} / {{ getTypeName(editedProblem.category, editedProblem.type) }}
        </div>
        <hr/>
        <div class="row">
            <div class="col-lg-12">
                <div class="card card-default mb-3">
                    <div class="card-header">
                        <i class="fa fa-cog fa-fw"></i> Setting of Problem 
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-sm-5 mb-3">
                                <input name="title" class="form-control needfull" placeholder=" * Title" title="Title" [(ngModel)]="editedProblem.title" required reverse="true" maxlength="255" #title="ngModel">
                                <small [hidden]="title.valid || (title.pristine && savefalg)" class="text-danger">
                                    Title is required for 1~255 chars.
                                </small>
                            </div>
                            <div class="col-sm-3">
                                <select name="degree" class="form-control" title="Degree" [(ngModel)]="editedProblem.degree" required reverse="true" #degree="ngModel">
                                    <option *ngFor="let i of pdegree" [ngValue]="i.value" ng-selected="i.value==editedProblem.degree">{{i.title}}</option>
                                </select>
                                <small [hidden]="degree.valid || (degree.pristine && savefalg )" class="text-danger">
                                    Degree is required.
                                </small>
                            </div>
                            <div class="col-sm-2 mb-3">
                                <input type="number" min="0" name="limit_time" class="form-control needfull" placeholder=" * LimitTime" title="LimitTime" [(ngModel)]="editedProblem.limit_time" required reverse="true" #limit_time="ngModel">
                                <small [hidden]="limit_time.valid || (limit_time.pristine && savefalg)" class="text-danger">
                                    Limit Time is required for number(second unit).
                                </small>
                            </div>
                            <div class="col-sm-2">
                                <input type="number" min="0" name="points" class="form-control needfull" placeholder="* Points" title="Points" [(ngModel)]="editedProblem.points" required reverse="true" #points="ngModel">
                                <small [hidden]="points.valid || (points.pristine && savefalg)" class="text-danger">
                                    Points is required for number(marks).
                                </small>
                            </div>
                        </div>
                        <textarea name="guide" class="form-control" placeholder="Guide" title="Guide" rows="3" [(ngModel)]="editedProblem.guide"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="card card-default mb-3">
                    <div class="card-header">
                        <i class="fa fa-edit fa-fw"></i> Edit of Problem 
                    </div>
                    <div class="card-body">
                        <div *ngIf="editedProblem.type == 'WSM' || editedProblem.type =='WES' || editedProblem.type =='SAL'">
                            <textarea name="sentences" class="form-control" placeholder="Text" title="Text" rows="5" [(ngModel)]="editedProblem.content.text"></textarea>
                        </div>
                        <div *ngIf="editedProblem.type =='SRS' || editedProblem.type =='SSA' || editedProblem.type =='LWS' || editedProblem.type =='LSA' || editedProblem.type =='LTW' || editedProblem.type =='LSB' ||  editedProblem.type =='LCD' || editedProblem.type =='LTS'">
                            <p class="form-group my-2" style="width: 100%;">
                                Select a Audio (mp3/wav):
                            </p>                            
                            <fieldset class="form-group my-6">
                                <div class="row">
                                    <div class="col-lg-4" style="padding-left: 1em;">
                                        <audio controls="false" autoplay="{{audio_autoplay}}" onpause="">
                                           <source src="/upload/q2/{{editedProblem.id}}/{{editedProblem.content.audio}}" type="audio/mpeg">
                                        </audio>
                                        <input type="text" class="form-control" title="already uploaded filename" value="{{editedProblem.content.audio}}" disabled>
                                    </div>
                                    <div class="col-lg-8">                                        
                                        <div class="dropzone" id="dzaudiofile"></div>
                                        <!-- <input filestyle="" class="col-lg-5" type="file" data-button-text="Single" data-class-button="btn btn-default" data-classinput="form-control inline" nv-file-select="" class="form-control" #audioproblemFile /> -->
                                        <!-- <file-upload url="/problem/uploadfile" id="audioproblemFile" file-name="{{editedProblem.content.audio}}" accept=""></file-upload> -->
                                    </div>
                                </div>
                            </fieldset>                            
                        </div>                        
                        <div *ngIf="editedProblem.type =='SRL'">
                            <div class="row">
                                <input type="text" name="sentences" class="form-control" placeholder="Text" title="Text" [(ngModel)]="editedProblem.content.text" />
                                
                                <p class="form-group my-2" style="width: 100%;">
                                    Select a Audio : 
                                </p>
                                <!-- <fieldset class="form-group my-6">
                                    <input filestyle="" type="file" data-button-text="Single" data-class-button="btn btn-default" data-classinput="form-control inline" nv-file-select="" class="form-control" #lectureproblemFile id="lectureproblemFile" />
                                </fieldset>  -->                                     
                            </div>
                        </div>
                        <div *ngIf="editedProblem.type == 'RSA'  ||  editedProblem.type == 'RMA' || editedProblem.type =='SPI'">
                            <div *ngIf="editedProblem.type == 'RSA'  ||  editedProblem.type == 'RMA'">
                                <textarea name="sentences1"class="form-control" placeholder="Text" title="Text" rows="3" [(ngModel)]="editedProblem.content.text"></textarea>
                            </div>
                            
                            <p class="form-group my-2" style="width: 100%;">
                                Select a Picture (jpeg/jpg/png): 
                            </p>
                            <fieldset class="form-group my-6">
                            	<div class="row">
                                    <div class="col-lg-4" style="padding-left: 1em;">
                                        <img src="/upload/q2/{{editedProblem.id}}/{{editedProblem.content.picture}}" />
                                        <input type="text" class="form-control" title="already uploaded filename" value="{{editedProblem.content.picture}}" disabled>
                                    </div>
                                    <div class="col-lg-8">
                                        <div class="dropzone" id="dzpicturefile"></div>
                                    </div>
                                    <!-- <div class="col-lg-8">
                                        <input filestyle="" class="col-lg-5" type="file" data-button-text="Single" data-class-button="btn btn-default" data-classinput="form-control inline" nv-file-select="" class="form-control" #pictureproblemFile >
                                    </div> -->
                                </div>
                            </fieldset>                                    
                            
                            <hr/>
                            <div *ngIf="editedProblem.type == 'RSA'  ||  editedProblem.type == 'RMA'">
                                <textarea name="select_guide" class="form-control" placeholder="Guide for multiple-choice" title="Guide for multiple-choice" rows="2" [(ngModel)]="editedProblem.content.select.guide"></textarea>
                                <label style="margin-top: 10px;"> List of candidates </label>
                                <select id="select_options" name="list_sentences" class="form-control" (change)="onChangeProbSelect()" [(ngModel)]="select_problem_values" multiple>
                                    <option *ngFor="let op of editedProblem.content.select.options" value="{{op}}">{{op}}</option>
                                </select>
                                <div class="form-group input-group">
                                    <input id="option_sentence" name="optionSentence" #optionsentence class="form-control mr-2" placeholder="Sentence" title="Sentence" [(ngModel)]="strOptionSentence">
                                    <p class="form-group my-2">
                                        <button class="btn btn-sm btn-success" type="button" (click)="onAddOption()"><i class="fa fa-plus-square fa-fw"></i> Add</button>
                                        <button id="btnEditOption" class="btn btn-sm btn-success" type="button" (click)="onEditOption()" *ngIf="show_editoption" [disabled]="dis_editoption"><i class="fa fa-pencil-square fa-fw"></i> Edit</button>
                                        <button id="btnChangeOption" type="button" class="btn btn-sm btn-success" (click)="onChangeOption()" *ngIf="show_chngoption"><i class="fa fa-pencil-square fa-fw"></i> Change</button>
                                        <button id="btnDeleteOption" type="button" class="btn btn-sm btn-success" (click)="onDeleteOption()" [disabled]="dis_deleteoption"><i class="fa fa-minus-square fa-fw"></i> Delete</button>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="editedProblem.type == 'LSA' || editedProblem.type == 'LSB'">
                            <textarea name="select_guide" class="form-control" placeholder="Guide for multiple-choice" title="Guide for multiple-choice" rows="2" [(ngModel)]="editedProblem.content.select.guide"></textarea>
                            <label style="margin-top: 10px;"> List of candidates </label>
                            <select id="select_options" name="list_sentences" class="form-control" (change)="onChangeProbSelect()" [(ngModel)]="select_problem_values" multiple>
                                <option *ngFor="let op of editedProblem.content.select.options" value="{{op}}">{{op}}</option>
                            </select>
                            <div class="form-group input-group">
                                <input id="option_sentence" name="optionSentence" #optionsentence class="form-control mr-2" placeholder="Sentence" title="Sentence" [(ngModel)]="strOptionSentence">
                                <p class="form-group my-2">
                                    <button class="btn btn-sm btn-success" type="button" (click)="onAddOption()"><i class="fa fa-plus-square fa-fw"></i> Add</button>
                                    <button id="btnEditOption" class="btn btn-sm btn-success" type="button" (click)="onEditOption()" *ngIf="show_editoption" [disabled]="dis_editoption"><i class="fa fa-pencil-square fa-fw"></i> Edit</button>
                                    <button id="btnChangeOption" type="button" class="btn btn-sm btn-success" (click)="onChangeOption()" *ngIf="show_chngoption"><i class="fa fa-pencil-square fa-fw"></i> Change</button>
                                    <button id="btnDeleteOption" type="button" class="btn btn-sm btn-success" (click)="onDeleteOption()" [disabled]="dis_deleteoption"><i class="fa fa-minus-square fa-fw"></i> Delete</button>
                                </p>
                            </div>
                        </div>
                        <div *ngIf="editedProblem.type == 'RRO'">
                            <label> List of target </label>
                            <div class="form-group input-group">
                                <table>
                                <tr><td style="width: 100%;">
                                <select id="select_options" name="list_sentences" class="form-control" (change)="onChangeProbSelect()" rows="10" [(ngModel)]="select_problem_values" style="width: 100%;" multiple>
                                    <option *ngFor="let op of editedProblem.content.select.options" value="{{op}}">{{op}}</option>
                                </select>
                                </td><td>
                                <table>
                                <tr><td style="padding-left: 5px;">
                                    <button class="btn btn-sm btn-success" type="button" (click)="onUpOption()"><i class="fa fa-chevron-up fa-fw"></i></button>
                                </td></tr>
                                <tr><td style="padding-left: 5px;">
                                    <button class="btn btn-sm btn-success" type="button" (click)="onDownOption()"><i class="fa fa-chevron-down fa-fw"></i></button>
                                </td></tr>
                                </table>
                                </td></tr>
                                </table>
                            </div>
                            <div class="form-group input-group">
                                <input id="option_sentence" name="optionSentence" #optionsentence class="form-control" placeholder="Sentence" title="Sentence" [(ngModel)]="strOptionSentence">
                                <p class="form-group my-2">
                                    <button class="btn btn-sm btn-success" type="button" (click)="onAddOption()"><i class="fa fa-plus-square fa-fw"></i> Add</button>
                                    <button id="btnEditOption" class="btn btn-sm btn-success" type="button" (click)="onEditOption()" *ngIf="show_editoption" [disabled]="dis_editoption"><i class="fa fa-pencil-square fa-fw"></i> Edit</button>
                                    <button id="btnChangeOption" type="button" class="btn btn-sm btn-success" (click)="onChangeOption()" *ngIf="show_chngoption"><i class="fa fa-pencil-square fa-fw"></i> Change</button>
                                    <button id="btnDeleteOption" type="button" class="btn btn-sm btn-success" (click)="onDeleteOption()" [disabled]="dis_deleteoption"><i class="fa fa-minus-square fa-fw"></i> Delete</button>
                                </p>
                            </div>
                        </div>
                        <div *ngIf="editedProblem.type == 'RFB'  ||  editedProblem.type == 'LTW'  ||  editedProblem.type == 'LCD'">
                            <textarea id="ck_editor" class="form-control" placeholder="Sentences" title="Sentences" rows="5"></textarea>
                            <div class="row">
                                <div class="col-sm-4"></div>
                                <div class="input-group col-sm-4">
                                    <input *ngIf="editedProblem.type == 'RFB'" class="form-control my-2" name="blank" placeholder="Blank" title="Blank" [(ngModel)]="str_blank" disabled>
                                    <input *ngIf="editedProblem.type == 'LTW'" class="form-control my-2" name="blank" placeholder="Blank" title="Blank" [(ngModel)]="str_blank">
                                    <input *ngIf="editedProblem.type == 'LCD'" class="form-control my-2" name="differ" placeholder="Differ" title="Differ" [(ngModel)]="str_blank">
                                    <button class="btn btn-sm btn-success my-2" type="button" (click)="onBlankClick()"><i class="fa fa-plus-square fa-fw"></i> Add</button>
                                </div>
                                <div class="col-sm-4"></div>
                            </div>
                            <div *ngIf="editedProblem.type == 'RFB'" class="row">
                                <div class="col-sm-3"></div>
                                <div class="col-sm-6">
                                    <label> List of candidates </label>
                                    <select id="select_options" name="list_sentences" class="form-control" (change)="onChangeProbSelect()" [(ngModel)]="select_problem_values" multiple>
                                        <option *ngFor="let op of editedProblem.content.select.options" value="{{op}}">{{op}}</option>
                                    </select>
                                    <div class="form-group input-group">
                                        <input id="option_sentence" name="optionSentence" #optionsentence class="form-control mr-2" placeholder="Sentence" title="Word" [(ngModel)]="strOptionSentence">
                                        <p class="form-group my-2">
                                            <button class="btn btn-sm btn-success" type="button" (click)="onAddOption()"><i class="fa fa-plus-square fa-fw"></i> Add</button>
                                            <button id="btnEditOption" class="btn btn-sm btn-success" type="button" (click)="onEditOption()" *ngIf="show_editoption" [disabled]="dis_editoption"><i class="fa fa-pencil-square fa-fw"></i> Edit</button>
                                            <button id="btnChangeOption" type="button" class="btn btn-sm btn-success" (click)="onChangeOption()" *ngIf="show_chngoption"><i class="fa fa-pencil-square fa-fw"></i> Change</button>
                                            <button id="btnDeleteOption" type="button" class="btn btn-sm btn-success" (click)="onDeleteOption()" [disabled]="dis_deleteoption"><i class="fa fa-minus-square fa-fw"></i> Delete</button>
                                        </p>
                                    </div>
                                </div>
                                <div class="col-sm-3"></div>
                            </div>
                            {{createCkEditor()}}
                        </div>
                        <div *ngIf="editedProblem.type == 'RAN'">
                            <textarea id="ck_editor" class="form-control" placeholder="Sentences" title="Sentences" rows="5"></textarea>
                            <table width="100%" anign="center" style="margin-top: 5px;"><tr>
                                <td width="45%">
                                    <label> List of candidates </label>
                                    <div class="form-group input-group">
                                        <table>
                                        <tr><td style="width: 100%;">
                                        <select name="list_sentences" class="form-control" (change)="onChangeBlankSelect()" [(ngModel)]="select_blank_values" style="width: 100%;" multiple>
                                            <option *ngFor="let op of select_blank_options" value="{{op}}">{{op}}</option>
                                        </select>
                                        </td><td>
                                        <table>
                                        <tr><td style="padding-left: 5px;">
                                            <button class="btn btn-sm" type="button" (click)="onUpBlank()"><i class="fa fa-chevron-up fa-fw"></i></button>
                                        </td></tr>
                                        <tr><td style="padding-left: 5px;">
                                            <button class="btn btn-sm" type="button" (click)="onDownBlank()"><i class="fa fa-chevron-down fa-fw"></i></button>
                                        </td></tr>
                                        </table>
                                        </td></tr>
                                        </table>
                                    </div>
                                    <div class="form-group input-group">
                                        <input name="optionSentence" #optionsentence class="form-control mr-2" placeholder="Word" title="Word" [(ngModel)]="strOptionSentence">
                                        <p class="form-group my-2">
                                            <button class="btn btn-sm" type="button" (click)="onAddBlank()"><i class="fa fa-plus-square fa-fw"></i> Add</button>
                                            <button class="btn btn-sm" type="button" (click)="onEditBlank()" *ngIf="show_editoption" [disabled]="dis_editoption"><i class="fa fa-pencil-square fa-fw"></i> Edit</button>
                                            <button type="button" class="btn btn-sm" (click)="onChangeBlank()" *ngIf="show_chngoption"><i class="fa fa-pencil-square fa-fw"></i> Change</button>
                                            <button type="button" class="btn btn-sm" (click)="onDeleteBlank()" [disabled]="dis_deleteoption"><i class="fa fa-minus-square fa-fw"></i> Delete</button>
                                        </p>
                                    </div>
                                </td>
                                <td width="10%" align="center">
                                    <button class="btn btn-sm btn-success" type="button" (click)="onAddSelectToList()"> Add <i class="fa fa-chevron-right fa-fw"></i></button>
                                </td>
                                <td width="45%">
                                    <table class="table table-bordered table-hover table-striped">
                                    <thead>
                                        <th> Select</th>
                                        <th> Action</th>
                                    </thead>
                                    <tr *ngFor="let blank_select of blank_selectlist; let i = index">
                                        <td>
                                            <select name="list_sentences{{i}}" class="form-control" (change)="onChangeProbSelect()" [(ngModel)]="blank_select.select_value" style="width: 100%;">
                                                <option *ngFor="let op of blank_select.options" value="{{op}}" selected="blank_select.select_value=={{op}}">{{op}}</option>
                                            </select>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-warning"
                                                (click)="onAddSelect($event, i)">
                                                <i class="fa fa-chevron-up fa-fw"></i> Add
                                            </button>
                                            <button class="btn btn-sm btn-warning"
                                                (click)="onDeleteSelect(i)">
                                                <i class="fa fa-minus-square fa-fw"></i> Delete
                                            </button>
                                        </td>
                                    </tr>
                                </table>
                                </td>
                                </tr>
                            </table>
                            {{createCkEditor()}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="card card-default mb-3">
                    <div class="card-header">
                        <i class="fa fa-circle-o fa-fw"></i> Solution of Problem 
                    </div>
                    <div class="card-body">

                        <div *ngIf="editedProblem.type == 'WSM' || editedProblem.type == 'WES' || editedProblem.type == 'LWS' || editedProblem.type == 'LTS'">
                            <textarea name="solution" class="form-control" placeholder="Solution Sentences" title="Solution Sentences" rows="5" [(ngModel)]="editedProblem.solution.text"></textarea>
                        </div>
                        <div *ngIf="editedProblem.type == 'SAL' || editedProblem.type == 'SRS' || editedProblem.type == 'SPI' || editedProblem.type == 'SSA'" style="width: 100%;">
                            <div class="row">
                                <p class="form-group my-2" style="width: 100%;">
                                    Select a Audio : 
                                </p>
                                <fieldset class="form-group col-lg-12">
                                	<div class="row">
	                                    <div class="col-lg-4" style="padding-left: 1em;">
                                            <audio controls="false" autoplay="{{audio_autoplay}}" onpause="">
                                               <source src="/upload/s0/{{editedProblem.id}}/{{editedProblem.solution.audio}}" type="audio/mpeg">
                                            </audio>
	                                        <input type="text" class="form-control" title="already uploaded filename" value="{{editedProblem.solution.audio}}" disabled>
	                                    </div>
	                                    <div class="col-lg-8">
                                        <div class="dropzone" id="dzsolutionfile"></div>
	                                        <!-- <input filestyle="" type="file" data-button-text="Single" data-class-button="btn btn-default" data-classinput="form-control inline" nv-file-select="" class="form-control" #audiosolutionFile id="audiosolutionFile" /> -->
	                                    </div>
	                                </div>
                                </fieldset> 
                            </div>
                        </div>
                        <div *ngIf="editedProblem.type == 'RSA' || editedProblem.type == 'LSB'">
                            <select id="select_solution_singleoptions" name="list_sentences" class="form-control" (change)="onChangeSolutionSelect()" [(ngModel)]="select_solution_value">
                                <option *ngFor="let op of editedProblem.content.select.options" ng-selected="op==select_value" value="{{op}}">{{op}}</option>
                            </select>
                        </div>
                        <div *ngIf="editedProblem.type == 'RMA' || editedProblem.type == 'LSA'">
                            <select id="select_solution_multipleoptions" name="list_sentences" class="form-control" (change)="onChangeSolutionMultipleSelect()" [(ngModel)]="select_solution_values" multiple>
                                <option *ngFor="let op of editedProblem.content.select.options" ng-selected="for(var i = 0;  i < select_values.length;  i++){ if(op==select_values[i]) return true;} return false;" value="{{op}}">{{op}}</option>
                            </select>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <hr/>
        <div class="row">
            <div class="col text-right">
            <p class="ng-tns-c14-20 my-2">
                <button class="btn btn-sm btn-primary" type="button" (click)="onClickList()"><i class="fa fa-table fa-fw"></i> List</button>
                <button class="btn btn-sm btn-primary" type="button" (click)="onClickUpdate()"><i class="fa fa-save fa-fw"></i> Save</button>
                <!-- <button class="btn btn-sm btn-primary" type="button" (click)="onClickPreview()"><i class="fa fa-play fa-fw"></i> Preview</button>                     -->
            </p>
            </div>
        </div>
    </form>
    </div>
</section>

